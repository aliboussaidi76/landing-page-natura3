<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ù†Ø§Ø­Ù„ Ø¢Ù„ Ø¨ÙˆØ³Ø¹ÙŠØ¯ÙŠ â€” Ø®Ù„Ø·Ø© ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© ÙˆÙØªØ­ Ø§Ù„Ø´Ù‡ÙŠØ©</title>
<meta name="description" content="Ø¹Ø³Ù„ Ø·Ø¨ÙŠØ¹ÙŠ ÙˆØ®Ù„Ø·Ø§Øª Ù„ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø¹Ø©ØŒ ÙØªØ­ Ø§Ù„Ø´Ù‡ÙŠØ©ØŒ Ø§Ù„Ù†Ù…Ùˆ - ØªÙˆØµÙŠÙ„ Ù„Ø¬Ù…ÙŠØ¹ ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ÙˆØ§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…">
<meta name="keywords" content="Ø¹Ø³Ù„, Ù…Ù†Ø§Ø­Ù„, ØºØ°Ø§Ø¡ Ù…Ù„ÙƒØ§Øª, Ø­Ø¨ÙˆØ¨ Ù„Ù‚Ø§Ø­, Ø¨Ø±ÙˆØ¨ÙˆÙ„ÙŠØ³, Ø¹Ø³Ù„ Ø§Ù„Ø³Ø¯Ø±, Ø®Ù„Ø·Ø© Ù…Ù†Ø§Ø¹Ø©, Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±">

<style>
:root{
  --orange:#ff7a00;
  --gold:#d4af37;
  --dark:#0b0b0b;
  --muted:#6b4f3a;
  --card:#fff;
  --radius:14px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Tajawal", "Segoe UI", Tahoma, Arial, sans-serif;background:linear-gradient(180deg,#fffaf0,#fff8e6);color:var(--dark)}
.container{max-width:1100px;margin:18px auto;padding:0 16px}
header{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:linear-gradient(90deg,var(--gold),var(--orange));color:#fff;box-shadow:0 8px 30px rgba(0,0,0,0.08)}
.logo{display:flex;align-items:center;gap:12px}
.logo .mark{width:64px;height:64px;border-radius:12px;background:rgba(255,255,255,0.12);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:26px}
.logo .text{line-height:1}
.logo .title{font-weight:900;font-size:20px}
.header-right{display:flex;align-items:center;gap:12px}
.call-btn{background:#000;color:#fff;padding:9px 14px;border-radius:10px;text-decoration:none;font-weight:800}

.hero{display:flex;gap:20px;align-items:center;flex-wrap:wrap;margin-top:18px}
.hero-card{flex:1;min-width:320px;background:var(--card);padding:20px;border-radius:var(--radius);box-shadow:0 14px 40px rgba(0,0,0,0.08)}
.hero-image{width:420px;min-width:260px;border-radius:12px;overflow:hidden;box-shadow:0 12px 30px rgba(0,0,0,0.06)}
.hero h1{margin:0;font-size:28px;color:var(--dark);text-align:center}
.hero h2{margin:8px 0 0;color:var(--muted);text-align:center}

.price-line{margin-top:12px;font-weight:900;text-align:center;color:var(--dark)}

.offers{display:flex;gap:10px;justify-content:center;margin-top:12px;flex-wrap:wrap}
.offer-pill{padding:12px 16px;border-radius:12px;background:#fff;border:2px solid transparent;cursor:pointer;font-weight:900;min-width:170px;text-align:center}
.offer-pill.selected{background:linear-gradient(90deg,var(--gold),var(--orange));color:#fff;border-color:rgba(255,255,255,0.12)}

.cta-row{display:flex;gap:10px;justify-content:center;margin-top:16px}
.btn{padding:12px 16px;border-radius:12px;border:none;cursor:pointer;font-weight:900}
.btn.primary{background:var(--orange);color:#fff}
.btn.ghost{background:#fff;border:2px solid var(--orange);color:var(--orange)}

.why{margin-top:18px;padding:18px;background:linear-gradient(180deg,#fffaf0,#fff6df);border-radius:12px;border:1px solid rgba(184,134,11,0.06)}
.why h3{color:var(--gold);margin-top:0}
.why p{color:#4a3b2f;line-height:1.7;text-align:justify}

.product-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:18px}
.prod{display:flex;flex-direction:column;gap:12px;align-items:center;padding:12px;background:var(--card);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.06)}
.prod img{width:120px;height:84px;object-fit:cover;border-radius:8px}
.prod h4{margin:6px 0}
.stars{color:#f5b301;font-size:16px;margin-top:6px}

/* Checkout */
.checkout{display:flex;gap:14px;margin-top:22px;flex-wrap:wrap;align-items:flex-start;justify-content:space-between}
.order-form{flex:1;min-width:320px;background:var(--card);padding:18px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.06)}
.summary{width:360px;min-width:300px;background:var(--card);padding:18px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.06)}
label{display:block;margin:10px 0 6px;font-weight:800}
input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #eee;margin-bottom:8px}
.row{display:flex;justify-content:space-between;margin-bottom:8px}
.small{font-size:13px;color:var(--muted)}

#cartBox{position:fixed;left:18px;bottom:90px;width:360px;max-height:60vh;background:var(--card);box-shadow:0 18px 60px rgba(0,0,0,0.12);border-radius:12px;padding:12px;overflow:auto;display:none;z-index:999}
#floatOrder{position:fixed;left:0;right:0;bottom:0;background:#000;color:#fff;padding:14px;text-align:center;font-weight:900;cursor:pointer;z-index:1000}

footer{margin-top:30px;padding:18px;text-align:center;color:var(--muted)}

/* responsive */
@media (max-width:1000px){
  .product-grid{grid-template-columns:repeat(2,1fr)}
  .summary{width:100%}
  .hero-image{width:100%}
}
@media (max-width:600px){
  h1{font-size:22px}
  .product-grid{grid-template-columns:1fr}
  header{flex-wrap:wrap;gap:8px;padding:10px}
}
</style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <header>
    <div class="logo">
      <div class="mark">Ù…</div>
      <div class="text"><div class="title">Ù…Ù†Ø§Ø­Ù„ Ø¢Ù„ Ø¨ÙˆØ³Ø¹ÙŠØ¯ÙŠ</div><div style="font-size:12px">Ø¹Ø³Ù„ Ù†Ù‚ÙŠ ÙˆØ®Ù„Ø·Ø§Øª Ø¹Ù„Ø§Ø¬ÙŠØ©</div></div>
    </div>
    <div class="header-right">
      <div style="background:rgba(255,255,255,0.12);padding:8px 10px;border-radius:8px;font-weight:800">ğŸšš ØªÙˆØµÙŠÙ„ Ù„ÙƒÙ„ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª â€” Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</div>
      <a class="call-btn" href="tel:+213550123456">ğŸ“ Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù† <strong>+213550123456</strong></a>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-card">
      <h1>Ø®Ù„Ø·Ø© ØªÙ‚ÙˆÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© ÙˆØ²ÙŠØ§Ø¯Ø© Ø§Ù„Ø´Ù‡ÙŠØ© ÙˆØ§Ù„Ù†Ù…Ùˆ â€” Ù„Ù„Ø£Ø·ÙØ§Ù„ ÙˆØ§Ù„ÙƒØ¨Ø§Ø±</h1>
      <h2>Ù…Ø²ÙŠØ¬ Ø·Ø¨ÙŠØ¹ÙŠ Ù…Ù† Ø¹Ø³Ù„ Ù†Ù‚ÙŠØŒ ØºØ°Ø§Ø¡ Ù…Ù„ÙƒØ§ØªØŒ Ø­Ø¨ÙˆØ¨ Ù„Ù‚Ø§Ø­ ÙˆØ¨Ø±ÙˆØ¨ÙˆÙ„ÙŠØ³ â€” Ù†ØªØ§Ø¦Ø¬ Ù…ÙØ´Ø¬Ø¹Ø© ÙˆÙ…Ø°Ø§Ù‚ Ù„Ø°ÙŠØ°</h2>
      <div class="price-line">Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚: 1 Ø¹Ø¨ÙˆØ© â€” <strong>2800 Ø¯.Ø¬</strong> | 2 Ø¹Ø¨ÙˆØªÙŠÙ† â€” <strong>5000 Ø¯.Ø¬</strong> (ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ) | 3 Ø¹Ø¨ÙˆØ§Øª +1 Ù…Ø¬Ø§Ù†Ø§Ù‹ â€” <strong>8400 Ø¯.Ø¬</strong></div>

      <div style="margin-top:12px;font-weight:900;text-align:center">Ù„Ù„Ø·Ù„Ø¨ Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙŠ ÙŠÙ†Ø§Ø³Ø¨Ùƒ</div>
      <div class="offers" role="tablist" aria-label="Ø¹Ø±ÙˆØ¶">
        <div class="offer-pill selected" data-key="one" onclick="uiChooseOffer('one')">1 Ø¹Ø¨ÙˆØ© â€” 2800 Ø¯Ø¬</div>
        <div class="offer-pill" data-key="two" onclick="uiChooseOffer('two')">2 Ø¹Ø¨ÙˆØªÙŠÙ† â€” 5000 Ø¯Ø¬ (Ù…Ø¬Ø§Ù†ÙŠ)</div>
        <div class="offer-pill" data-key="four" onclick="uiChooseOffer('four')">3 Ø¹Ø¨ +1 Ù…Ø¬Ø§Ù†Ø§Ù‹ â€” 8400 Ø¯Ø¬ (Ù…Ø¬Ø§Ù†ÙŠ)</div>
      </div>

      <div class="cta-row">
        <button class="btn primary" onclick="onBuyNow()">Ø§Ø´ØªØ±ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©</button>
        <button class="btn ghost" id="addOfferBtn" onclick="onAddOffer()">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
      </div>

      <div class="why" aria-label="Ù„Ù…Ø§Ø°Ø§">
        <h3>Ù„Ù…Ø§Ø°Ø§ Ø·ÙÙ„Ùƒ ÙÙŠ Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø³Ù„ØŸ</h3>
        <p>Ù…Ù„Ø¹Ù‚Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹ Ù…Ù† Ø®Ù„Ø·Ø© Ù…Ù†Ø§Ø­Ù„ Ø¢Ù„ Ø¨ÙˆØ³Ø¹ÙŠØ¯ÙŠ ØªÙ…Ù†Ø­ Ø·ÙÙ„Ùƒ Ø·Ø§Ù‚Ø© ÙˆØ­ÙŠÙˆÙŠØ©ØŒ ØªÙØªØ­ Ø§Ù„Ø´Ù‡ÙŠØ©ØŒ ØªØ¯Ø¹Ù… Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙˆØªØ­Ø³Ù‘Ù† Ø§Ù„ØªØ±ÙƒÙŠØ² ÙˆØ§Ù„Ø°Ø§ÙƒØ±Ø©. ØªØ­ØªÙˆÙŠ Ø§Ù„Ø®Ù„Ø·Ø© Ø¹Ù„Ù‰ Ù…Ø¶Ø§Ø¯Ø§Øª Ø£ÙƒØ³Ø¯Ø© ÙˆÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª Ø·Ø¨ÙŠØ¹ÙŠØ© ØªØ²ÙŠØ¯ Ù…Ù† Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©.</p>
      </div>
    </div>

    <div class="hero-image">
      <!-- Ø®Ø°Ù†Ø§ ØµÙˆØ±Ø© Ø§Ù„Ø·ÙÙ„+Ø¹Ø³Ù„ ÙƒÙ€ SVG Ø®ÙÙŠÙ -->
      <img alt="Ø·ÙÙ„ ÙŠØ£ÙƒÙ„ Ø¹Ø³Ù„" src="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600'%3E%3Crect width='100%25' height='100%25' rx='12' fill='%23fff5e1'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Tahoma' font-size='28' fill='%23b8860b'%3EØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬%3C/text%3E%3C/svg%3E"/>
    </div>
  </section>

  <!-- Upsells -->
  <section>
    <h3 style="color:var(--gold);text-align:center;margin-top:20px">Ù…Ù†ØªØ¬Ø§Øª Ù…ÙƒÙ…Ù‘Ù„Ø© â€” Ø£Ø¶ÙÙ‡Ø§ Ù„Ø³Ù„Ø© Ù…Ø´ØªØ±ÙŠØ§ØªÙƒ</h3>
    <div id="upsellGrid" class="product-grid" aria-live="polite"></div>
  </section>

  <!-- Checkout -->
  <section class="checkout">
    <div class="order-form">
      <h3 style="margin-top:0">Ø·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬</h3>
      <form id="orderForm" onsubmit="return submitOrder(event)">
        <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
        <input id="custName" name="name" type="text" required>

        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
        <input id="custPhone" name="phone" type="tel" required placeholder="Ù…Ø«Ø§Ù„: 0550123456">

        <label>Ø§Ù„ÙˆÙ„Ø§ÙŠØ©</label>
        <select id="wilaya" name="wilaya" required onchange="recalculate()">
          <option value="">Ø§Ø®ØªØ± ÙˆÙ„Ø§ÙŠØªÙƒ</option>
        </select>

        <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù…)</label>
        <input id="address" name="address" type="text" required>

        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
        <textarea id="notes" name="notes" rows="3"></textarea>

        <input type="hidden" id="itemsInput" name="items">
        <input type="hidden" id="subtotalInput" name="subtotal">
        <input type="hidden" id="shippingInput" name="shipping">
        <input type="hidden" id="totalInput" name="total">

        <div style="margin-top:12px">
          <button class="btn primary" type="submit">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
        </div>
      </form>
    </div>

    <div class="summary">
      <h3 style="margin-top:0">ğŸ›’ Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ù„Ø©</h3>
      <div id="cartItemsSummary" class="small">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>
      <div class="row"><div class="small">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</div><div id="subtotal">0 Ø¯.Ø¬</div></div>
      <div class="row"><div class="small">ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„</div><div id="shipping">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©</div></div>
      <hr style="border:none;border-top:1px dashed #f0d9b3;margin:10px 0"/>
      <div class="row" style="font-weight:900"><div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</div><div id="total">0 Ø¯.Ø¬</div></div>

      <div style="margin-top:12px">
        <button class="btn ghost" onclick="toggleCartBox()">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©</button>
      </div>

      <div style="margin-top:12px;font-size:13px;color:var(--muted)">
        ğŸ” <strong>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹:</strong> ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ„Ù Ø£Ùˆ Ø®Ù„Ù„ Ø§Ù„ØªØºÙ„ÙŠÙ Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù… â€” Ù†Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù…Ù†ØªØ¬ Ø£Ùˆ Ù†ÙØ±Ø¬Ø¹ Ø§Ù„Ù…Ø¨Ù„Øº Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©.
        <div style="margin-top:8px">ğŸ¢ Â© Ø´Ø±ÙƒØ© Ù…Ù†Ø§Ø­Ù„ Ø¢Ù„ Ø¨ÙˆØ³Ø¹ÙŠØ¯ÙŠ</div>
      </div>
    </div>
  </section>

  <footer>
    Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±: <a href="tel:+213550123456">+213 550 123 456</a> â€” Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙ„ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª
  </footer>
</div>

<!-- cart box & float -->
<div id="cartBox"></div>
<div id="floatOrder" onclick="scrollToCheckout()">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</div>

<script>
/* -------------------------
   Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Google Web App Ø¨Ø¹Ø¯ Ù†Ø´Ø± Code.gs ÙƒÙ€ Web App
   Ù…Ø«Ø§Ù„: ""
   ------------------------- */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxJS2fklP1BwLamYjjDdSG5g2kr8wmF1JcGRqFoW4ALC4KHD8Msh9HJUi3xh4hCRyJHmw/exec";

/* Products list (offers + upsells) */
const PRODUCTS = [
  {id:'main_one',title:'Ø®Ù„Ø·Ø© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© â€” 1 Ø¹Ø¨ÙˆØ©',price:2800,qty:1,freeShipping:false},
  {id:'main_two',title:'Ø®Ù„Ø·Ø© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© â€” 2 Ø¹Ø¨ÙˆØªÙŠÙ†',price:5000,qty:2,freeShipping:true},
  {id:'main_four',title:'Ø®Ù„Ø·Ø© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© â€” 3 Ø¹Ø¨ÙˆØ§Øª +1 Ù…Ø¬Ø§Ù†Ø§Ù‹',price:8400,qty:4,freeShipping:true},

  {id:'sidr',title:'Ø¹Ø³Ù„ Ø§Ù„Ø³Ø¯Ø± (500Øº)',price:3500,qty:1,imgText:'Ø¹Ø³Ù„ Ø§Ù„Ø³Ø¯Ø±'},
  {id:'azhar',title:'Ø¹Ø³Ù„ Ø§Ù„Ø£Ø²Ù‡Ø§Ø± (500Øº)',price:3000,qty:1,imgText:'Ø¹Ø³Ù„ Ø§Ù„Ø£Ø²Ù‡Ø§Ø±'},
  {id:'jibi',title:'Ø§Ù„Ø¹Ø³Ù„ Ø§Ù„Ø¬Ø¨Ù„ÙŠ (500Øº)',price:4000,qty:1,imgText:'Ø§Ù„Ø¹Ø³Ù„ Ø§Ù„Ø¬Ø¨Ù„ÙŠ'},
  {id:'fat',title:'Ø®Ù„Ø·Ø© Ø§Ù„ØªØ³Ù…ÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ',price:5000,qty:1,imgText:'Ø®Ù„Ø·Ø© Ø§Ù„ØªØ³Ù…ÙŠÙ†'},
  {id:'sex',title:'Ø®Ù„Ø·Ø© Ø§Ù„Ù‚Ø¯Ø±Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ©',price:6000,qty:1,imgText:'Ø®Ù„Ø·Ø© Ø§Ù„Ù‚Ø¯Ø±Ø©'},
  {id:'bedwet',title:'Ø®Ù„Ø·Ø© Ø§Ù„ØªØ¨ÙˆÙ„ Ø§Ù„Ù„Ø§Ø§Ø±Ø§Ø¯ÙŠ',price:6500,qty:1,imgText:'Ø®Ù„Ø·Ø© Ø§Ù„ØªØ¨ÙˆÙ„'},
  {id:'resp',title:'Ø®Ù„Ø·Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„ØªÙ†ÙØ³ÙŠ ÙˆØ§Ù„Ø³Ø¹Ø§Ù„',price:5500,qty:1,imgText:'Ø®Ù„Ø·Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„ØªÙ†ÙØ³ÙŠ'}
];

/* ====== Shipping prices for 58 wilayas (ØªÙ‚Ø¯ÙŠØ±ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø¹Ø¯ Ø¹Ù† Ø§Ù„Ø¹Ø§ØµÙ…Ø©) ====== */
const shippingPrices = {
 "Ø£Ø¯Ø±Ø§Ø±":800,"Ø§Ù„Ø´Ù„Ù":400,"Ø§Ù„Ø£ØºÙˆØ§Ø·":600,"Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ":500,"Ø¨Ø§ØªÙ†Ø©":600,"Ø¨Ø¬Ø§ÙŠØ©":400,"Ø¨Ø³ÙƒØ±Ø©":600,"Ø¨Ø´Ø§Ø±":900,"Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©":300,"Ø§Ù„Ø¨ÙˆÙŠØ±Ø©":400,
 "ØªÙ…Ù†Ø±Ø§Ø³Øª":1000,"ØªØ¨Ø³Ø©":600,"ØªÙ„Ù…Ø³Ø§Ù†":500,"ØªÙŠØ§Ø±Øª":500,"ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ":400,"Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±":300,"Ø§Ù„Ø¬Ù„ÙØ©":500,"Ø¬ÙŠØ¬Ù„":400,"Ø³Ø·ÙŠÙ":500,"Ø³Ø¹ÙŠØ¯Ø©":600,
 "Ø³ÙƒÙŠÙƒØ¯Ø©":500,"Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³":500,"Ø¹Ù†Ø§Ø¨Ø©":500,"Ù‚Ø§Ù„Ù…Ø©":500,"Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©":500,"Ø§Ù„Ù…Ø¯ÙŠØ©":350,"Ù…Ø³ØªØºØ§Ù†Ù…":450,"Ø§Ù„Ù…Ø³ÙŠÙ„Ø©":500,"Ù…Ø¹Ø³ÙƒØ±":500,"ÙˆØ±Ù‚Ù„Ø©":900,
 "ÙˆÙ‡Ø±Ø§Ù†":400,"Ø§Ù„Ø¨ÙŠØ¶":700,"Ø¥Ù„ÙŠØ²ÙŠ":1000,"Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬":450,"Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³":350,"Ø§Ù„Ø·Ø§Ø±Ù":600,"ØªÙ†Ø¯ÙˆÙ":1100,"ØªÙŠØ³Ù…Ø³ÙŠÙ„Øª":500,"Ø§Ù„ÙˆØ§Ø¯ÙŠ":800,"Ø®Ù†Ø´Ù„Ø©":600,
 "Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³":650,"ØªÙŠØ¨Ø§Ø²Ø©":320,"Ù…ÙŠÙ„Ø©":500,"Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰":480,"Ø§Ù„Ù†Ø¹Ø§Ù…Ø©":800,"Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª":450,"ØºØ±Ø¯Ø§ÙŠØ©":900,"ØºÙ„ÙŠØ²Ø§Ù†":500,"ØªÙŠÙ…ÙŠÙ…ÙˆÙ†":950,"Ø¨Ø±Ø¬ Ø¨Ø§Ø¬ÙŠ Ù…Ø®ØªØ§Ø±":1200,
 "Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„":900,"Ø¨Ù†ÙŠ Ø¹Ø¨Ø§Ø³":800,"Ø¹ÙŠÙ† ØµØ§Ù„Ø­":1200,"Ø¹ÙŠÙ† Ù‚Ø²Ø§Ù…":1200,"ØªÙ‚Ø±Øª":1000,"Ø¬Ø§Ù†Øª":1200,"Ø§Ù„Ù…ØºÙŠØ±":1000,"Ø§Ù„Ù…Ù†ÙŠØ¹Ø©":900,"ØªÙŠØ¨Ø§Ø²Ø©2":320
};

/* Note: shippingPrices includes all main 58 wilayas; remove duplicate keys if any. 
   You can edit prices easily. */

/* ====== State ====== */
let cart = [];
let selectedOffer = 'main_one';

/* ====== Util ====== */
function format(num){ return (num||0).toLocaleString() + " Ø¯.Ø¬"; }
function findProduct(id){ return PRODUCTS.find(p=>p.id===id); }
function createDataImg(text,w=400,h=260){
  return "data:image/svg+xml;utf8," + encodeURIComponent(
    `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}'><rect rx='12' width='100%' height='100%' fill='%23fff5e1'/><text x='50%' y='50%' text-anchor='middle' dominant-baseline='middle' font-family='Tahoma' font-size='20' fill='%23b8860b'>${text}</text></svg>`
  );
}

/* ====== render upsells ====== */
function renderUpsells(){
  const grid = document.getElementById('upsellGrid');
  grid.innerHTML = '';
  PRODUCTS.filter(p=>!p.id.startsWith('main')).forEach(p=>{
    const el = document.createElement('div');
    el.className = 'prod card';
    el.innerHTML = `
      <img src="${createDataImg(p.imgText||p.title)}" alt="${p.title}">
      <h4>${p.title}</h4>
      <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
      <div style="font-weight:900;margin-top:6px">${p.price.toLocaleString()} Ø¯.Ø¬</div>
      <button id="btn-${p.id}">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
    `;
    grid.appendChild(el);
    document.getElementById('btn-'+p.id).addEventListener('click', function(){
      addToCart(p.id);
      this.style.background = '#00a86b';
      setTimeout(()=> this.style.background = '',700);
    });
  });
}
renderUpsells();

/* ====== populate wilayas select ====== */
function populateWilayas(){
  const sel = document.getElementById('wilaya');
  const keys = Object.keys(shippingPrices).sort((a,b)=>a.localeCompare(b,'ar'));
  keys.forEach(w=>{
    const opt = document.createElement('option');
    opt.value = w;
    opt.textContent = w + " â€” " + (shippingPrices[w] ? shippingPrices[w] + " Ø¯Ø¬" : "");
    sel.appendChild(opt);
  });
}
populateWilayas();

/* ====== Offers UI ====== */
function uiChooseOffer(key){
  selectedOffer = (key==='two')? 'main_two' : (key==='four')? 'main_four' : 'main_one';
  document.querySelectorAll('.offer-pill').forEach(el=>el.classList.remove('selected'));
  document.querySelectorAll('.offer-pill').forEach(el=>{
    if(el.dataset.key===key) el.classList.add('selected');
  });
}

/* ====== Cart functions ====== */
function addToCart(id){
  const p = findProduct(id);
  if(!p) return;
  const existing = cart.find(x=>x.id===id);
  if(existing) existing.qty += p.qty || 1;
  else cart.push({id:p.id,title:p.title,price:p.price,qty:p.qty||1,freeShipping:!!p.freeShipping});
  saveCart(); renderCart(); showCartBox();
}
function removeFromCart(i){
  if(i>=0 && i<cart.length) cart.splice(i,1);
  saveCart(); renderCart();
}
function clearCart(){ cart=[]; saveCart(); renderCart(); }

function saveCart(){ localStorage.setItem('manahil_cart', JSON.stringify(cart)); }
function loadCart(){ try{ cart = JSON.parse(localStorage.getItem('manahil_cart')||'[]')||[]; }catch(e){cart=[];} renderCart(); }

/* ====== render cart & totals ====== */
function renderCart(){
  const summary = document.getElementById('cartItemsSummary');
  if(cart.length===0){
    summary.innerHTML = "<div class='small'>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>";
  } else {
    summary.innerHTML = cart.map((it,i)=>{
      return `<div style="margin-bottom:10px"><strong>${it.title}</strong> â€” ${format(it.price)} Ã— ${it.qty} <button style="margin-left:8px;background:#e74c3c;border:none;color:#fff;padding:6px;border-radius:8px;cursor:pointer" onclick="removeFromCart(${i})">Ø­Ø°Ù</button></div>`;
    }).join('');
  }
  const subtotal = cart.reduce((s,i)=>s + (i.price*(i.qty||1)), 0);
  document.getElementById('subtotal').innerText = format(subtotal);
  recalculate();
}

/* ====== shipping & recalc ====== */
function recalculate(){
  const wilaya = document.getElementById('wilaya').value;
  const subtotal = cart.reduce((s,i)=>s + (i.price*(i.qty||1)), 0);
  const totalPacks = cart.reduce((s,i)=>s + (i.qty||1), 0);
  const freeByItem = cart.some(i=>i.freeShipping);
  const freeByQty = totalPacks > 1;
  const freeBySubtotal = subtotal >= 5000;
  let shipping = 0;
  if(!freeByItem && !freeByQty && !freeBySubtotal){
    shipping = (wilaya && shippingPrices[wilaya])? shippingPrices[wilaya] : 0;
  } else {
    shipping = 0;
  }
  document.getElementById('shipping').innerText = shipping? format(shipping) : 'Ù…Ø¬Ø§Ù†ÙŠ';
  document.getElementById('total').innerText = format(subtotal + shipping);
  document.getElementById('subtotalInput').value = subtotal;
  document.getElementById('shippingInput').value = shipping;
  document.getElementById('totalInput').value = subtotal + shipping;
  document.getElementById('itemsInput').value = JSON.stringify(cart);
}

/* ====== cart box ====== */
function showCartBox(){
  const el = document.getElementById('cartBox');
  el.style.display = 'block';
  el.innerHTML = '<h4 style="margin:6px 0">Ø³Ù„Ø© Ù…Ø´ØªØ±ÙŠØ§ØªÙƒ</h4>' + (cart.length ? cart.map((it,i)=>`<div style="margin-bottom:8px"><strong>${it.title}</strong><div class="small">${format(it.price)} Ã— ${it.qty} <button onclick="removeFromCart(${i})" style="margin-left:8px;padding:6px;border-radius:6px;background:#e74c3c;color:#fff;border:none">Ø­Ø°Ù</button></div></div>`).join('') : '<div class="small">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>') + '<div style="text-align:center;margin-top:8px"><button onclick="hideCartBox()" style="padding:8px;border-radius:8px;border:none;background:#eee;cursor:pointer">Ø¥ØºÙ„Ø§Ù‚</button></div>';
}
function hideCartBox(){ document.getElementById('cartBox').style.display='none'; }
function toggleCartBox(){ const b=document.getElementById('cartBox'); if(b.style.display==='block') hideCartBox(); else showCartBox(); }
function scrollToCheckout(){ document.getElementById('orderForm').scrollIntoView({behavior:'smooth',block:'center'}); }

/* ====== offers actions ====== */
function onAddOffer(){
  addToCart(selectedOffer);
  const btn = document.getElementById('addOfferBtn');
  btn.style.background = '#00a86b';
  setTimeout(()=>btn.style.background='',700);
}
function onBuyNow(){
  cart = [];
  const p = findProduct(selectedOffer);
  if(p) cart.push({id:p.id,title:p.title,price:p.price,qty:p.qty||1,freeShipping:!!p.freeShipping});
  saveCart(); renderCart();
  scrollToCheckout();
  setTimeout(()=>document.getElementById('custName').focus(),300);
}

/* ====== submit order ====== */
async function submitOrder(e){
  if(e && e.preventDefault) e.preventDefault();

  const name = document.getElementById('custName').value.trim();
  const phone = document.getElementById('custPhone').value.trim();
  const wilaya = document.getElementById('wilaya').value;
  const address = document.getElementById('address').value.trim();
  const notes = document.getElementById('notes').value.trim();

  if(!name || !phone || !wilaya){ alert('Ø±Ø¬Ø§Ø¡Ù‹ Ø£ÙƒÙ…Ù„ Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„ÙˆÙ„Ø§ÙŠØ©'); return false; }
  if(cart.length===0){ alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©. Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Ù‹ Ø£Ùˆ Ø§Ø®ØªØ± Ø¹Ø±Ø¶Ø§Ù‹.'); return false; }

  recalculate();
  const payload = {
    timestamp: new Date().toISOString(),
    name, phone, wilaya, address, notes,
    items: cart,
    subtotal: parseInt(document.getElementById('subtotalInput').value||0,10),
    shipping: parseInt(document.getElementById('shippingInput').value||0,10),
    total: parseInt(document.getElementById('totalInput').value||0,10)
  };

  try{
    const res = await fetch(SCRIPT_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    const data = await res.json().catch(()=>null);
    if(!res.ok || (data && data.status==='error')){
      throw new Error((data && data.message) ? data.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨');
    }
    // Ù†Ø¬Ø§Ø­
    clearCart();
    window.location.href = 'thankyou.html';
  } catch(err){
    console.error(err);
    alert('Ø­ØµÙ„ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨: ' + err.message + '\nØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ Ù†Ø´Ø±Øª Google Apps Script ÙƒÙ€ Web App ÙˆÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ SCRIPT_URL ØµØ­ÙŠØ­.');
  }

  return false;
}

/* init */
(function init(){
  uiChooseOffer('one');
  loadCart();
  renderCart();
  document.getElementById('floatOrder').addEventListener('click', scrollToCheckout);
})();
</script>

</body>
</html>












